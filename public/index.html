<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resume-Job Fit Analyzer</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>üìÑ Resume-Job Fit Analyzer</h1>
            <p>Using Tiger Data's Agentic Postgres with BM25 & Vector Search</p>
        </header>

        <main>
            <!-- Input Section -->
            <section class="input-section">
                <div class="form-group">
                    <h2>Step 1: Upload Resume</h2>
                    <div class="upload-area" id="uploadArea">
                        <input type="file" id="resumeFile" accept=".pdf,.txt,.doc,.docx" hidden>
                        <div class="upload-placeholder">
                            <p>üìÅ Click or drag resume file here</p>
                            <small>PDF, TXT, or DOC files (max 10MB)</small>
                        </div>
                    </div>
                    <div id="resumeStatus" class="status-message"></div>
                </div>

                <div class="form-group">
                    <h2>Step 2: Job Description</h2>
                    <input type="text" id="jobTitle" placeholder="Job Title (e.g., Senior Python Developer)" class="input-field">
                    <textarea id="jobDescription" placeholder="Paste the job description here..." class="input-field" rows="8"></textarea>
                    <input type="number" id="jobYears" placeholder="Required Years of Experience (optional)" class="input-field" min="0">
                    <div id="jobStatus" class="status-message"></div>
                </div>

                <button id="analyzeBtn" class="button button-primary" disabled>
                    ‚ö° Analyze Fit
                </button>
            </section>

            <!-- Results Section -->
            <section class="results-section" id="resultsSection" style="display: none;">
                <h2>üìä Fit Score Results</h2>

                <!-- NEW: Learning Widget -->
                <div id="learning-widget" class="learning-indicator" style="display: none;">
                    <div class="spinner"></div>
                    <p>üß† Learning from your resume... <span id="discovery-count">0</span> new items found</p>
                </div>

                <!-- Composite Score Card -->
                <div class="score-card composite-score">
                    <div class="score-value" id="compositeScore">-</div>
                    <div class="score-label">Overall Fit Score</div>
                </div>

                <!-- Score Breakdown -->
                <div class="breakdown-section">
                    <h3>Score Breakdown</h3>
                    <p class="breakdown-intro">Your fit score is calculated across five key dimensions:</p>

                    <div class="score-item">
                        <div class="score-label">
                            <span class="label-main">Technical Skills Match</span>
                            <span class="label-weight">25%</span>
                        </div>
                        <div class="score-tooltip">How well your skills align with the job requirements</div>
                        <div class="score-bar">
                            <div class="score-fill" id="keywordFill" style="width: 0%"></div>
                        </div>
                        <div class="score-details">
                            <span id="keywordScore">-</span>
                            <span class="score-percent">/ 100</span>
                        </div>
                    </div>

                    <div class="score-item">
                        <div class="score-label">
                            <span class="label-main">Job Description Relevance</span>
                            <span class="label-weight">15%</span>
                        </div>
                        <div class="score-tooltip">Semantic match between your background and job description</div>
                        <div class="score-bar">
                            <div class="score-fill semantic" id="semanticFill" style="width: 0%"></div>
                        </div>
                        <div class="score-details">
                            <span id="semanticScore">-</span>
                            <span class="score-percent">/ 100</span>
                        </div>
                    </div>

                    <div class="score-item">
                        <div class="score-label">
                            <span class="label-main">Years of Experience</span>
                            <span class="label-weight">10%</span>
                        </div>
                        <div class="score-tooltip">Whether your experience meets or exceeds the requirement</div>
                        <div class="score-bar">
                            <div class="score-fill structured" id="structuredFill" style="width: 0%"></div>
                        </div>
                        <div class="score-details">
                            <span id="structuredScore">-</span>
                            <span class="score-percent">/ 100</span>
                        </div>
                    </div>

                    <div class="score-item">
                        <div class="score-label">
                            <span class="label-main">Education Level Match</span>
                            <span class="label-weight">30%</span>
                        </div>
                        <div class="score-tooltip">How your degree level aligns with job requirements</div>
                        <div class="score-bar">
                            <div class="score-fill education" id="educationFill" style="width: 0%"></div>
                        </div>
                        <div class="score-details">
                            <span id="educationScore">-</span>
                            <span class="score-percent">/ 100</span>
                        </div>
                    </div>

                    <div class="score-item">
                        <div class="score-label">
                            <span class="label-main">Relevant Certifications</span>
                            <span class="label-weight">20%</span>
                        </div>
                        <div class="score-tooltip">Professional certifications that match job requirements</div>
                        <div class="score-bar">
                            <div class="score-fill certification" id="certificationFill" style="width: 0%"></div>
                        </div>
                        <div class="score-details">
                            <span id="certificationScore">-</span>
                            <span class="score-percent">/ 100</span>
                        </div>
                    </div>
                </div>

                <!-- Resume & Job Info -->
                <div class="info-section">
                    <div class="info-card">
                        <h4>Resume Analysis</h4>
                        <div id="resumeInfo"></div>
                    </div>
                    <div class="info-card">
                        <h4>Job Requirements</h4>
                        <div id="jobInfo"></div>
                    </div>
                </div>

                <!-- Delete Actions -->
                <div class="delete-actions-section" id="deleteActionsSection">
                    <h3>üóëÔ∏è Data Management</h3>
                    <p class="delete-info">Delete uploaded resume and job after use. This cannot be undone.</p>
                    <div class="delete-buttons">
                        <button id="deleteResumeBtn" class="button button-danger">
                            üóëÔ∏è Delete Resume
                        </button>
                        <button id="deleteJobBtn" class="button button-danger">
                            üóëÔ∏è Delete Job
                        </button>
                        <button id="resetBtn" class="button button-secondary">
                            üîÑ Reset & Start Over
                        </button>
                    </div>
                </div>

                <!-- Technical Details -->
                <div class="details-section">
                    <h3>üîß Technical Details</h3>
                    <div class="details-grid">
                        <div class="detail-item">
                            <span class="label">Embedding Method:</span>
                            <span id="embeddingMethod" class="value">-</span>
                        </div>
                        <div class="detail-item">
                            <span class="label">BM25 Search:</span>
                            <span class="value">‚úì pg_textsearch</span>
                        </div>
                        <div class="detail-item">
                            <span class="label">Vector DB:</span>
                            <span class="value">‚úì pgvector</span>
                        </div>
                        <div class="detail-item">
                            <span class="label">Database:</span>
                            <span class="value">‚úì Tiger Cloud</span>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Error Message -->
            <div id="errorMessage" class="error-message" style="display: none;"></div>
        </main>

        <footer>
            <p>üöÄ Resume-Job Fit using Tiger Data's Agentic Postgres</p>
            <p><small>Features: BM25 Full-Text Search | Vector Embeddings | Fast Forks | Fluid Storage</small></p>
        </footer>
    </div>

    <script src="app.js"></script>
</body>
</html>
